<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Links</title>

  <style>
    .column {
      float: left;
      width: 33.33%;
    }

    /* Clear floats after the columns */
    .row:after {
      content: "";
      display: table;
      clear: both;
    }

    @media screen and (-webkit-device-pixel-ratio: 3) {
      .column {
        width: 100%;
      }
    }
  </style>
</head>
<body>

  <h1><a href="./">.</a> / Links</h1>
  <form onsubmit="search();return false;">
    <input type="search" placeholder="Search Web" id="search_term" autofocus />
  </form>

  <div id="content"></div>


  <script>

    function search() {
        const query = document.getElementById("search_term").value;
        window.location.href = `https://neeva.com/search?q=${query}`;
    }

    function get_data() {
      fetch("resources/links.json")
      .then(response => response.json())
      .then(json => load_links(json));
    }

    function load_links(data) {
      var page_content = "";
      data.groups.forEach((e,i) => {
        // Every 3rd group, start a row
        if ((i % 3) == 0) {
          page_content = `${page_content}<div class="row">`;
        }

        page_content = `${page_content}
        <div class="column">
          <h2>${e.title}</h2>
            <ul>`;

        e.links.forEach(f => {
          page_content = `${page_content}
            <li><a href="${f.url}">${f.name}</a></li>
          `;
        });

        page_content = `${page_content}
            </ul>
          </div>
        `;

        if ((i % 3) == 2) {
          page_content = `${page_content}</div>`;
        }

      });

      document.getElementById("content").innerHTML = page_content;
      console.log(page_content);
    }

    window.onload = () => get_data();
  </script>

</body>
</html>
